"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLocalConfigDir = exports.getDefaultLocalNetworksConfigPath = exports.parseLocalNetworksConfigPath = exports.readLocalNetworksConfig = void 0;
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const os_1 = require("os");
const config_1 = require("hardhat/config");
const HARDHAT_CONFIG_DIR = '.hardhat';
const HARDHAT_NETWORK_CONFIG_FILE = 'networks.json';
config_1.extendConfig((hardhatConfig, userConfig) => {
    const localNetworksConfig = readLocalNetworksConfig(userConfig);
    const userNetworkConfigs = userConfig.networks || [];
    Object.entries(userNetworkConfigs).forEach(([networkName, userNetworkConfig]) => {
        hardhatConfig.networks[networkName] = Object.assign({}, hardhatConfig.networks[networkName], localNetworksConfig.defaultConfig, localNetworksConfig.networks[networkName] || {}, userNetworkConfig);
    });
    Object.entries(localNetworksConfig.networks).forEach(([networkName, localNetworkConfig]) => {
        if (!hardhatConfig.networks[networkName]) {
            hardhatConfig.networks[networkName] = Object.assign({}, hardhatConfig.networks[networkName], localNetworksConfig.defaultConfig, localNetworkConfig);
        }
    });
});
function readLocalNetworksConfig(userConfig) {
    const localNetworksConfigPath = parseLocalNetworksConfigPath(userConfig);
    const localNetworksConfig = localNetworksConfigPath ? require(localNetworksConfigPath) : {};
    if (!localNetworksConfig.networks)
        localNetworksConfig.networks = [];
    if (!localNetworksConfig.defaultConfig)
        localNetworksConfig.defaultConfig = {};
    return localNetworksConfig;
}
exports.readLocalNetworksConfig = readLocalNetworksConfig;
function parseLocalNetworksConfigPath(userConfig) {
    const localNetworksConfigPath = userConfig.localNetworksConfig;
    if (typeof localNetworksConfigPath === 'string' && fs_1.default.existsSync(localNetworksConfigPath)) {
        return localNetworksConfigPath;
    }
    const defaultLocalNetworksConfigPath = getDefaultLocalNetworksConfigPath();
    return fs_1.default.existsSync(defaultLocalNetworksConfigPath) ? defaultLocalNetworksConfigPath : undefined;
}
exports.parseLocalNetworksConfigPath = parseLocalNetworksConfigPath;
function getDefaultLocalNetworksConfigPath() {
    return path_1.default.join(getLocalConfigDir(), HARDHAT_NETWORK_CONFIG_FILE);
}
exports.getDefaultLocalNetworksConfigPath = getDefaultLocalNetworksConfigPath;
function getLocalConfigDir() {
    return path_1.default.join(os_1.homedir(), HARDHAT_CONFIG_DIR);
}
exports.getLocalConfigDir = getLocalConfigDir;
//# sourceMappingURL=index.js.map